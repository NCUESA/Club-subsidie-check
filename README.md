# 社團津貼申請與進度查詢平台

## 專案簡介

這是一個前端獨立的社團津貼申請與進度查詢平台。它旨在提供一個清晰、易用的介面，讓社團成員能夠：
1.  方便地**下載**津貼申請所需的相關文件。
2.  透過一組獨特的**查核密碼**，查詢其申請案件的審核進度與結果。

本平台所有資料均透過 Google Sheets API 動態載入，管理者只需維護一份 Google 試算表即可即時更新所有查詢資料。
其樣式由於是要嵌入 rpage 系統中，因此需重新規劃，而現今仍會與外部樣式發生衝突。

## 主要功能

*   **文件下載區**：集中展示所有申請所需表單，並提供 DOCX 和 PDF 格式的下載連結。
*   **進度查詢系統**：使用者輸入其申請時獲得的查核密碼，即可查詢對應的審核狀態。
*   **動態資料載入**：所有審核資料皆從指定的 Google 試算表中讀取，後端維護簡單方便。
*   **詳細狀態顯示**：清晰地以表格呈現「初審」、「複審」及「活動資料」等各階段的審核人員、日期、結果與金額。
*   **響應式設計 (RWD)**：
    *   **電腦版**：寬螢幕顯示，版面清晰大方，充分利用顯示空間。
    *   **手機版**：查詢結果表格會自動變為**水平滑動**模式，確保在小螢幕上也能完整瀏覽所有欄位，不破壞排版。
*   **樣式隔離設計**：所有 HTML 和 CSS 都被包裹在一個獨立的 class (`.club-subsidy-inquiry-app`) 之下，能有效避免嵌入頁面（如 rpage）的既有樣式污染到本平台，確保顯示的正確性。(現今版本電腦檢視仍有誤!)

## 如何部署與設定

這份程式碼是一個完整的 HTML 檔案，可以直接使用。若要將其部署到您的網站或 rpage 平台，請遵循以下步驟。

### 步驟一：準備 Google 試算表

您需要一份符合特定格式的 Google 試算表來存放所有申請資料。

1.  建立一份新的 Google 試算表。
2.  依照以下格式建立欄位。**欄位的順序至關重要**，因為程式是透過欄位索引值 (Index) 來抓取資料的。

| 欄位 (英文) | 欄位 (中文)     | 索引值 | 說明                                |
| :---------- | :-------------- | :----- | :---------------------------------- |
| A           | 初審-審核人     | 0      |                                     |
| B           | 初審-審核日期   | 1      |                                     |
| C           | 初審-審核結果   | 2      |                                     |
| D           | *(未使用)*      | 3      | *程式會跳過此欄*                    |
| E           | 通過金額        | 4      |                                     |
| F           | 實際核銷金額    | 5      |                                     |
| G           | 複審-審核人     | 6      |                                     |
| H           | 複審-審核日期   | 7      |                                     |
| I           | 複審-審核結果   | 8      |                                     |
| J           | *(未使用)*      | 9      | *程式會跳過此欄*                    |
| K           | 申請進度        | 10     |                                     |
| L           | 匯款金額        | 11     |                                     |
| M           | 備註            | 12     |                                     |
| ...         | ...             | ...    | *中間欄位可自由使用*                |
| S           | 活動名稱        | 18     |                                     |
| T           | 活動日期        | 19     |                                     |
| **U**       | **查核密碼**    | **20** | **這是使用者用來查詢的密碼，最重要！** |

3.  **開放共用權限**：點擊右上角的「共用」，將權限設定為「**知道連結的任何人均可檢視**」。這是必要的步驟，否則 API 將無法讀取到資料。

### 步驟二：取得 Google Sheets API 金鑰

1.  前往 [Google Cloud Console](https://console.cloud.google.com/)。
2.  建立一個新專案 (或選取現有專案)。
3.  在左側導覽列中，前往「API 和服務」>「已啟用的 API 和服務」。
4.  點擊「+ 啟用 API 和服務」，搜尋並啟用 **Google Sheets API**。
5.  前往「API 和服務」>「憑證」。
6.  點擊「+ 建立憑證」，選擇「**API 金鑰**」。系統會產生一組金鑰，請將其複製下來。
7.  **限制金鑰網域**：為了安全起見，已將金鑰限制在學生會網域，以確保金鑰只能在學生會網站上被使用。

### 步驟三：修改程式碼

用文字編輯器打開 `index.html` (或您收到的程式碼檔案)，找到 `<script>` 區塊中的以下變數，並填入您自己的資訊：

```javascript
// --- Google Sheets API 設定 ---
var spreadsheet_id = "1HPZ6lbAu615E3JEnxIO4SHDVUWQu2FtZvGtXDQC9rhM", // 填入「試算表 ID」
    tab_name = "sheet2", // 填入「工作表名稱」
    api_key = "AIzaSyD4Oxgb4ZMw6zt-41DZXQZzyxquiAKd1yc", // 填入「API 金鑰」
    url = "https://sheets.googleapis.com/v4/spreadsheets/" + spreadsheet_id + "/values/" + tab_name + "?key=" + api_key;
```
*   **試算表 ID**：可以從試算表的網址中找到，例如 `.../spreadsheets/d/`**`[這一段就是ID]`**`/edit#gid=0`。

### 步驟四：嵌入至目標網頁

將**完整的、修改過的程式碼**複製並貼到您的 rpage 網站的 HTML 原始碼編輯器中。由於整個平台已被樣式隔離，它應該可以正常顯示而不會出現版面錯誤。

## 相依性

*   [**jQuery**](https://jquery.com/)：用於簡化 DOM 操作與 AJAX 請求。
*   [**Google Fonts**](https://fonts.google.com/) (`Noto Sans TC`)：提供更美觀的中文字體。

---